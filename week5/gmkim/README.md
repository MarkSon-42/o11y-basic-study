# Ch 4 : 오픈소스 관측 가능성, 그라파나


## 4.1 그라파나 관측 가능성

### 4.1.1 목적과 범위

#### Grafana LGTM 스택
- 로키 : 로그 관리
- 그라파나 : 대시보드
- 템포 : 추적 관리
- 미미르 : 메트릭 관리

#### 그라파나의 장점
- 대중적이고 라이선스에 자유로운 오픈소스
- 지속적이고 장기적인 로드맵과 많은 커뮤니티
- 기술적으로 우수하고 클러스터 구성이 가능하며 많은 API 제공

#### 준비 사항 - 구성 순서
1. 인프라 구성
2. 캐시, 객체 스토리지, 서비스 디스커버리 등 공통적으로 사용하는 애플리케이션 구성
3. 그라파나 관측 가능성 구성

### 4.1.2 인프라 구성
> - 우분투 20.04
> - 미니쿠브 v1.21.0
> - 쿠버네티스 버전 1.20.0
> - 크롬 브라우저
> - Go 1.16.5
> - 헬름 3


### 4.1.3 애플리케이션 구성

#### 미니오
- 오픈소스 객체 스토리지
  - 일반 파일 시스템에 비해서 관리와 구성 측면에서 장점을 제공
- AWS S3와 호환되는 API 제공
  - AWS 운영 환경이라면 _S3_, 클라우드 네이티브 환경으로 다양한 플랫폼을 이용하면 _미니오_ 권장
- 상세한 메트릭과 수치를 제공 → 성능 개선 작업에 GOOD
  - 그라파나 관측 가능성은 디스크 IO에서 가장 큰 성능 감소가 발생하기 때문에, 이를 모니터링하고 성능을 개선하기 위한 튜닝과 작업에 용이

#### 레디스
- 오픈소스 캐시
  - NoSQL 지원
  - 높은 수준의 처리 속도 달성에 GOOD
- 샤딩을 사용해서 클러스터를 구성하고 메모리에서 운영됨
  - 디스크에 비해서 수십 배 빠른 성능
- 쿼리 처리 시에 데이터를 스토리지에서 읽어서 처리하는 것보다, *레디스 캐시에서 읽어서 처리하는 것*을 권장

#### 콘솔
- 오픈소스 서비스 레지스터리
  - HashiCorp에서 관리
  - 키-값 형식의 구성 관리 기능 제공
- 복잡한 네트워크 구성과 구성 정보 관리에 사용
  - 관측 가능성은 단독 서버가 아닌 다수의 서버로 클러스터를 구성하는 것이 일반적이기 때문에 GOOD

#### 카프카
- 오픈소스 데이터 분석 파이프라인
- 카프카 + 카프카 커넥터 조합 : 다양한 시스템에게 안정적으로 데이터 전달 가능
  - 로키에 직접적으로 파이프라인을 생성하는 것보다 권장 (e.g. 로키에서 로그 수집에 사용하는 프롬테일, 플루언트비트)

---


## 4.2 로키 로그 관리
